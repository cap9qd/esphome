esphome:
  name: tuya-temphumid-d7f4b9
  on_boot:
    priority: -100
    then:
      - light.turn_on: wifi_status
      - delay: 500ms
      - while:
          condition:
            not:
              wifi.connected
          then:
            - light.toggle: wifi_status
            - delay: 500ms
      - logger.log: "WiFi Connected!"
      - light.turn_on: wifi_status
      - logger.log: "Waiting for the API to connect..."
      - wait_until:
          condition:
            api.connected:
      - if:
          condition:
            api.connected:
          then:
            - logger.log: "API Connected"
          else:
            - logger.log: "API NOT Connected"  
      
bk72xx:
  board: cbu
  framework:
    version: 0.0.0
    source: https://github.com/cap9qd/libretiny.git#feature/i2c-spi
    
logger:
  baud_rate: 115200
  level: DEBUG
  hardware_uart: UART1

web_server:
  port: 80

captive_portal:

api:
  encryption:
    key: "mdpNNAkhq8oHz70F70BfDYPO7SMsU7j5ikGmXoNhpmg="

ota:
  password: "82f3fcc3db4d823f807f9115b79759f4"

wifi:
  networks:
    - ssid: !secret wifi_ssid
      password: !secret wifi_password

  ap:
    ssid: "TuYa Dev Blue Hotspot"
    password: "17jiH7OW8C4Q"

binary_sensor:
  - platform: gpio
    pin: 
      number: P14
      inverted: true
      mode:
        input: true
        pullup: true
    name: "Button"
  - platform: gpio
    id: alert
    pin: 
      number: P7
      inverted: true
      mode:
        input: true
        pullup: true
    name: "Alert"
    
output:
  - platform: gpio
    pin: 16
    id: status_led

light:
  - platform: binary
    id: wifi_status
    output: status_led
    restore_mode: ALWAYS_ON

switch:
  - platform: restart
    name: "Restart"
  - platform: safe_mode
    name: "Restart (Safe Mode)"
  - platform: gpio
    pin: 8
    name: "Power"
    restore_mode: ALWAYS_ON 
  
i2c:
  sda: P22
  scl: P20
  scan: true
  id: bus_a
  softwire: true
  
sensor:
  - platform: cht8310
    temperature:
      name: "Temperature"
      min_temp: 20.0
      max_temp: 30.0
    humidity:
      name: "Humidity"
      min_humid: 10.0
      max_humid: 95.0
    update_interval: 10s
    address: 0x40
  - platform: adc
    pin: P23
    name: "Battery Level"
    update_interval: 15s
    